{% extends "usu/base.html" %}
{% load static nvd3_tags %}

{% block page_title %}USU Weathermap{% endblock %}

{% block extrahead %}
    {{ block.super }}
    <link media="all" href="{% static 'usu/css/weathermap.css' %}" type="text/css" rel="stylesheet" />
    <link media="all" href="{% static 'usu/css/svg.css' %}" type="text/css" rel="stylesheet" />
    <style type="text/css">
        #map {
            background: url('/static/usu/img/campus_map.png') no-repeat center center;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;
            margin-top: 20px;
        }
    </style>
    <script type="text/javascript">
        $(function(){
            $("#weathermap_link").addClass('active');
        });
    </script>
{% endblock %}

{% block content %}
    <span id="mapName" /></span>
    <img id="logo" />

    <svg id="map" viewBox="0 0 1280 750" />

    <script src="{% static 'usu/js/d3.v3.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'usu/js/weathermap.js' %}" type="text/javascript"></script>


    <script type="text/javascript">
      var site = (window.location.href.match(/site=([^;&]+)/) || [])[1] || '';
      site = site ? site.concat(".") : site;
      (new Map("/static/usu/js/" + site + "config.json", "#map", "#time", "#mapName", "#acronym")).init();
      if (site) {
        d3.select('span#return').attr('style','display:inline');
        d3.select('span#site').text(site.toUpperCase().substr(0,site.length-1)).attr('style','display:inline');
      }
    </script>
{% endblock %}
